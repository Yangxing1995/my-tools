package cert

import (
	"reflect"
	"testing"
)

func TestSplitCertChain(t *testing.T) {
	type args struct {
		input string
	}
	tests := []struct {
		name    string
		args    args
		want    []string
		wantErr bool
	}{
		{
			name: "cert and chain",
			args: args{
				input: `-----BEGIN CERTIFICATE-----\nMIIE7DCCA9SgAwIBAgIFYQMWRggwDQYJKoZIhvcNAQELBQAwXTELMAkGA1UEBhMC\nQ04xMDAuBgNVBAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhv\ncml0eTEcMBoGA1UEAwwTQ0ZDQSBBQ1MgVEVTVCBPQ0EzMTAeFw0yNTEyMTkwNjE1\nMDBaFw0yNjEyMTkwNjE0NTlaMIGPMQswCQYDVQQGEwJDTjERMA8GA1UECAwIc2hh\nbmdoYWkxETAPBgNVBAcMCHNoYW5naGFpMUIwQAYDVQQKDDnkuprmlbDkv6Hmga/n\np5HmioDvvIjkuIrmtbfvvInmnInpmZDlhazlj7jvvIhPViDmtYvor5XvvIkxFjAU\nBgNVBAMMDWxldHNmaXJlLmNsdWIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK\nAoIBAQDTiBo16FXy4RSOE4tMyZXeX8np/4D031gHPYpX2QgxyqlYMrHQQ6ky+e1j\nW4WM8SeRSL1XmlY1xQqB3QhBz5LSo38dY2OFKjzERIAt+Gdp7cJq/SpTWO6ayccL\noQaI7nRlk247719ZWoGoZUDlQCEJqzFHX8UZSXi/hbPRLKnU45a2TbvLZK7Rfbga\njCoXOmO9RSZ33RgsosxbDd5w3+3PRP9NDFEe4Kvu9q0Hn6ECM9MyyQYyNOaoq4tC\nx2vuOBg4Yb3+PO1aLZqeCTTXTB5EQICfzX36cvrIlN2hVXoo3EZxS18cYWVAuvDR\nruiumFtZT2oncYRWT9Fc5NmdFTaTAgMBAAGjggF+MIIBejAJBgNVHRMEAjAAMD8G\nCCsGAQUFBwEBBDMwMTAvBggrBgEFBQcwAYYjaHR0cDovL29jc3B0ZXN0LmNmY2Eu\nY29tLmNuOjgwL29jc3AwDwYJKwYBBQUHMAEFBAIFADArBgNVHREEJDAigg1sZXRz\nZmlyZS5jbHVighF3d3cubGV0c2ZpcmUuY2x1YjALBgNVHQ8EBAMCBaAwHQYDVR0O\nBBYEFHM0jzyU3rJ3KgQ5feVrWXWaV6sCMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggr\nBgEFBQcDATAfBgNVHSMEGDAWgBSaPbSuZVj7zloFeCagbSsEhrrG7DBIBgNVHSAE\nQTA/MD0GCGCBHIbvKgEEMDEwLwYIKwYBBQUHAgEWI2h0dHA6Ly93d3cuY2ZjYS5j\nb20uY24vdXMvdXMtMTQuaHRtMDgGA1UdHwQxMC8wLaAroCmGJ2h0dHA6Ly8yMTAu\nNzQuNDIuMy9PQ0EzMS9SU0EvY3JsNDI4LmNybDANBgkqhkiG9w0BAQsFAAOCAQEA\no3vaOLObputX7T4vAbJSwBBnsi7Gkdz2/zJcY3hOIXXaz5i5KddL6l4I7MKIChn5\nt/2s1XZv0kKjqo73I4sV2+Zz2G3H3FMROHyQ6SX8q90XnkXvT1AaQVxHFoqDR8eH\nPGOBxrgOrcpTk6um+MDA1BElyTQmivOMvEj3+hB2BMQAE9SixW3ZcuSNPH6aQtFK\nM+oa5HVSfKELFCygSgoWlP2YFkJD/QnJ3rQG+CyPQBAw1kaIqPKTyUQ4s1SYQmej\nVt7npsv4IHG+h9eRlwDL8b4AZdQgzniq/lqfhjXnWog5+OlhclIfTOJl1TqXtdMm\nJL/B/kd/zicUx3/BfRzCVQ==\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIE3zCCAsegAwIBAgIQIBUE73ioT/uUtl5Th6tHXjANBgkqhkiG9w0BAQsFADBa\nMQswCQYDVQQGEwJDTjEwMC4GA1UECgwnQ2hpbmEgRmluYW5jaWFsIENlcnRpZmlj\nYXRpb24gQXV0aG9yaXR5MRkwFwYDVQQDDBBDRkNBIEFDUyBURVNUIENBMB4XDTE1\nMTAyMjA2MzExNFoXDTM1MTAxNzA2MzExNFowXTELMAkGA1UEBhMCQ04xMDAuBgNV\nBAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEcMBoG\nA1UEAwwTQ0ZDQSBBQ1MgVEVTVCBPQ0EzMTCCASIwDQYJKoZIhvcNAQEBBQADggEP\nADCCAQoCggEBAL4/zA8dovZQ7egRQmhWR2R4Y53pVI7zRsvz/6nv6W7F35L5S4ly\nqT+1fyHrXe4VZVnMtiHDE6x0Ex0IkYhQ5gaep/GbfvGOZoP9keSccFfkS/yhuDyu\nN5Po2XvXhdxy88FBAlZEy2R04jYiZvSZiCKF1y0TngpXPF+qorQ0SUWwTWgrm3gw\nQMaHMTGLQ2tRHqQv9xBtsTlFw1dwNHPHUUtsUhwRPPGJ+m6nVRxrKDnVAFT3mtEp\ni7s48/AEdT8JxB8BZ0KfE48YcZ9GZ3EbiF465pQ4C2pUImo4dlJaVKVRjq3Myhe4\nYtFH0/oPw8OM41BGp3/OBUbaSzyI1kIqE5MCAwEAAaOBnTCBmjAfBgNVHSMEGDAW\ngBSTXOb+MzFPYTFWEYzMV8ec6AtG+TAPBgNVHRMBAf8EBTADAQH/MDcGA1UdHwQw\nMC4wLKAqoCiGJmh0dHA6Ly8yMTAuNzQuNDIuMy9BQ1NfQ0EvUlNBL2NybDEuY3Js\nMA4GA1UdDwEB/wQEAwIBBjAdBgNVHQ4EFgQUmj20rmVY+85aBXgmoG0rBIa6xuww\nDQYJKoZIhvcNAQELBQADggIBAEBHxg3XmdRr7Oc4IdBtfx1uNEP4d9p8MNMyRlt0\ndk8FjvHPM+XO+8DSk5SzcHusbul+RR/PIkbHwcxVMMmBYO4wkWWhS3XfF+suwWK9\nBCjx4d+qqSa45APOgrohl8OfW1+08oPoafJyHOG0Uuz1iSSCQMOC+iAZNvC/vlDg\nZ8o1nvBYCWToFFEgjRou8y74xdsko6cMLqOHEKrPGcYTMRgOn71HC/N4t1GO0QND\nArjWhuTTy9pjMcf2t2ulZUPgF8PGb6OR9h0/JyHfACyS54mBiK9ucFX0jetfj36l\nwHhfJ76LdgpGbmDH6ev1c96iQa56orC3nnOOa5JAcv8+OoG/ENyFWR5lWRycz8Q7\nwJ1vViLFkZw07KD8GSGDr7pJ5BjUxdB/IshzKpu/HxUtSavWzy4CnM2u/ukR5+pZ\nGgfmQEwRam/5XkSPSjABtwa7ULuFEOXkKo6+UNAyPdYHMMccjqPwar2WPZgRbxMR\ntTGDF793LAImErdD0ksxq00zBI8hycGEXeEqsiOvuEttNVFWkY2XhvoCyH1s7I5D\ndSMhK08sHvJXY2F1r081G2J0UXM76VmvZ1HvdvSOgMDsp1CCN8yrMndQPB65c8vc\nUpGiChv2o0W5wrNHONSJLKXWlFIMIqOktMZfzA9Z8NIvSpEZibiYXHdzwHAjuB2f\no6Zr\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIFoTCCA4mgAwIBAgIQczwBVefwpYwDZO3tyHclMjANBgkqhkiG9w0BAQsFADBa\nMQswCQYDVQQGEwJDTjEwMC4GA1UECgwnQ2hpbmEgRmluYW5jaWFsIENlcnRpZmlj\nYXRpb24gQXV0aG9yaXR5MRkwFwYDVQQDDBBDRkNBIEFDUyBURVNUIENBMB4XDTE1\nMTAyMjAzMzgzMloXDTQzMDMwODAzMzgzMlowWjELMAkGA1UEBhMCQ04xMDAuBgNV\nBAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEZMBcG\nA1UEAwwQQ0ZDQSBBQ1MgVEVTVCBDQTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCC\nAgoCggIBAOAwANJxh6UQjnSrjGqQ2gRMwaSPrj0qXrKAvfsfBaeWCHo1BJF5FII0\nveKau4W76tr2z1a9UMeCurapIbWX/3AF1f3JDhI0t+E1i5F2JauVUSO8dGoL/7th\nyiz1LnG8DBm8dM02RFjQjSlMA4OIrHB/33C5DYNRsiIZnpB6Aoxc7rAvPmwWnirM\nwdEFEd01KzNyZJJ+HNuT/NTpkCRjBOTeoft8TE35kMN5B2JiVRVihqx2IUSOXUTk\niYMVxZUvJNwWaDokd0nAnJmFhYerhTt7xenEyy+Xkc9mQOI3WECdsfTD/4y80+Nj\nvx2FgSMXOxhsXdImTBnrSXabauPYS6AHOgPjLMuUVTUvnSDGQSUWsX78s+/0wseD\noKyyLwMcP605sfrCtAdCTPmNIGgV4rnHC+l1JA9z+lpepOqM0kpaxmXphLjgyy+N\ngpkh5aCj+pc/SzFlZCK9UuGgHb8M4x5fEG94OtAU//wGicwCNGpn2a2TsfYEguMP\nOydV2BDkauccgmHO+1Xp1qaB3TcBxmDLm0T+/Anlk1zAyWpyk5M/hb6spm2heIdH\nF87Fi3JBOik6UoRfMIsW3DKjNPdz7BbGIczomj38vSrt4IoiaWlxQPB4+UHnm9w+\nlsLSpCGloy1J2dvCxExbODAFM9Kcd9VbYvq5uLqL/7faivr8pSufAgMBAAGjYzBh\nMB8GA1UdIwQYMBaAFJNc5v4zMU9hMVYRjMxXx5zoC0b5MA8GA1UdEwEB/wQFMAMB\nAf8wDgYDVR0PAQH/BAQDAgEGMB0GA1UdDgQWBBSTXOb+MzFPYTFWEYzMV8ec6AtG\n+TANBgkqhkiG9w0BAQsFAAOCAgEAepGkL+SRw/wFZEd1SeaPPIsLq0hNepeFv4Zo\n3f1M4eRtFKJxXPCpT8T2UDh44Bvmarn01B7UnzTfMNWEUERpexS/ASHlPmmoQqNz\nhM4s4xNyTLL4JF4fnbE+OUrR1VFyrHujCNokSJDnxVHONWFRz1wNvdAoO+52UTRw\nvcVA9l0McDQcESnf7heJU9qbpOGwU8opz00vcjGhoP9imb6TWOo+i0OnstyeoGBT\nzMii5+VqU1n3ElPubxtLqUuYcfZimf3kiuU7TPk76c0udSuq5vwx7OlDIHQW/pd1\nHeBN4NM9fw9ptWcb8H8vYHkUhCm0S1qt4mHV7SX7PXb9mnlaQcsNKS558flLgs+3\nek9M8t/ynyFAoTN2ihVuAEzLidC+MCmJsCfMdzNkVlSVue2/GZMx1vwl8ZiSm72C\nlgHSAHb+pY/3SqLuXvCP1jI+asles2kBNhxMWDtCWOfm13k1jChvhKG7JId4XHh6\ntyUmgS8Knnsjn2Ez7n8L3a+2DjvAO1oqdQeKZG/knHpylKGk5tt0A2JZ8bMNWXcE\nDlVElu+fCAqKuAcomIpkIZ4LlN7vbIgxdd+RB5WywpwjTg8DGbRmKCQGohXDtxzJ\n++nQ9HF3mcjyhoWf8xykVGDDxrG6ypgGA0uyRuGOYdl8xWZ2f4XLrBWlf61Exz42\n7Q8IqjI=\n-----END CERTIFICATE-----`,
			},
			want: []string{
				`-----BEGIN CERTIFICATE-----
MIIE7DCCA9SgAwIBAgIFYQMWRggwDQYJKoZIhvcNAQELBQAwXTELMAkGA1UEBhMC
Q04xMDAuBgNVBAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhv
cml0eTEcMBoGA1UEAwwTQ0ZDQSBBQ1MgVEVTVCBPQ0EzMTAeFw0yNTEyMTkwNjE1
MDBaFw0yNjEyMTkwNjE0NTlaMIGPMQswCQYDVQQGEwJDTjERMA8GA1UECAwIc2hh
bmdoYWkxETAPBgNVBAcMCHNoYW5naGFpMUIwQAYDVQQKDDnkuprmlbDkv6Hmga/n
p5HmioDvvIjkuIrmtbfvvInmnInpmZDlhazlj7jvvIhPViDmtYvor5XvvIkxFjAU
BgNVBAMMDWxldHNmaXJlLmNsdWIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK
AoIBAQDTiBo16FXy4RSOE4tMyZXeX8np/4D031gHPYpX2QgxyqlYMrHQQ6ky+e1j
W4WM8SeRSL1XmlY1xQqB3QhBz5LSo38dY2OFKjzERIAt+Gdp7cJq/SpTWO6ayccL
oQaI7nRlk247719ZWoGoZUDlQCEJqzFHX8UZSXi/hbPRLKnU45a2TbvLZK7Rfbga
jCoXOmO9RSZ33RgsosxbDd5w3+3PRP9NDFEe4Kvu9q0Hn6ECM9MyyQYyNOaoq4tC
x2vuOBg4Yb3+PO1aLZqeCTTXTB5EQICfzX36cvrIlN2hVXoo3EZxS18cYWVAuvDR
ruiumFtZT2oncYRWT9Fc5NmdFTaTAgMBAAGjggF+MIIBejAJBgNVHRMEAjAAMD8G
CCsGAQUFBwEBBDMwMTAvBggrBgEFBQcwAYYjaHR0cDovL29jc3B0ZXN0LmNmY2Eu
Y29tLmNuOjgwL29jc3AwDwYJKwYBBQUHMAEFBAIFADArBgNVHREEJDAigg1sZXRz
ZmlyZS5jbHVighF3d3cubGV0c2ZpcmUuY2x1YjALBgNVHQ8EBAMCBaAwHQYDVR0O
BBYEFHM0jzyU3rJ3KgQ5feVrWXWaV6sCMB0GA1UdJQQWMBQGCCsGAQUFBwMCBggr
BgEFBQcDATAfBgNVHSMEGDAWgBSaPbSuZVj7zloFeCagbSsEhrrG7DBIBgNVHSAE
QTA/MD0GCGCBHIbvKgEEMDEwLwYIKwYBBQUHAgEWI2h0dHA6Ly93d3cuY2ZjYS5j
b20uY24vdXMvdXMtMTQuaHRtMDgGA1UdHwQxMC8wLaAroCmGJ2h0dHA6Ly8yMTAu
NzQuNDIuMy9PQ0EzMS9SU0EvY3JsNDI4LmNybDANBgkqhkiG9w0BAQsFAAOCAQEA
o3vaOLObputX7T4vAbJSwBBnsi7Gkdz2/zJcY3hOIXXaz5i5KddL6l4I7MKIChn5
t/2s1XZv0kKjqo73I4sV2+Zz2G3H3FMROHyQ6SX8q90XnkXvT1AaQVxHFoqDR8eH
PGOBxrgOrcpTk6um+MDA1BElyTQmivOMvEj3+hB2BMQAE9SixW3ZcuSNPH6aQtFK
M+oa5HVSfKELFCygSgoWlP2YFkJD/QnJ3rQG+CyPQBAw1kaIqPKTyUQ4s1SYQmej
Vt7npsv4IHG+h9eRlwDL8b4AZdQgzniq/lqfhjXnWog5+OlhclIfTOJl1TqXtdMm
JL/B/kd/zicUx3/BfRzCVQ==
-----END CERTIFICATE-----
`, `-----BEGIN CERTIFICATE-----
MIIE3zCCAsegAwIBAgIQIBUE73ioT/uUtl5Th6tHXjANBgkqhkiG9w0BAQsFADBa
MQswCQYDVQQGEwJDTjEwMC4GA1UECgwnQ2hpbmEgRmluYW5jaWFsIENlcnRpZmlj
YXRpb24gQXV0aG9yaXR5MRkwFwYDVQQDDBBDRkNBIEFDUyBURVNUIENBMB4XDTE1
MTAyMjA2MzExNFoXDTM1MTAxNzA2MzExNFowXTELMAkGA1UEBhMCQ04xMDAuBgNV
BAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEcMBoG
A1UEAwwTQ0ZDQSBBQ1MgVEVTVCBPQ0EzMTCCASIwDQYJKoZIhvcNAQEBBQADggEP
ADCCAQoCggEBAL4/zA8dovZQ7egRQmhWR2R4Y53pVI7zRsvz/6nv6W7F35L5S4ly
qT+1fyHrXe4VZVnMtiHDE6x0Ex0IkYhQ5gaep/GbfvGOZoP9keSccFfkS/yhuDyu
N5Po2XvXhdxy88FBAlZEy2R04jYiZvSZiCKF1y0TngpXPF+qorQ0SUWwTWgrm3gw
QMaHMTGLQ2tRHqQv9xBtsTlFw1dwNHPHUUtsUhwRPPGJ+m6nVRxrKDnVAFT3mtEp
i7s48/AEdT8JxB8BZ0KfE48YcZ9GZ3EbiF465pQ4C2pUImo4dlJaVKVRjq3Myhe4
YtFH0/oPw8OM41BGp3/OBUbaSzyI1kIqE5MCAwEAAaOBnTCBmjAfBgNVHSMEGDAW
gBSTXOb+MzFPYTFWEYzMV8ec6AtG+TAPBgNVHRMBAf8EBTADAQH/MDcGA1UdHwQw
MC4wLKAqoCiGJmh0dHA6Ly8yMTAuNzQuNDIuMy9BQ1NfQ0EvUlNBL2NybDEuY3Js
MA4GA1UdDwEB/wQEAwIBBjAdBgNVHQ4EFgQUmj20rmVY+85aBXgmoG0rBIa6xuww
DQYJKoZIhvcNAQELBQADggIBAEBHxg3XmdRr7Oc4IdBtfx1uNEP4d9p8MNMyRlt0
dk8FjvHPM+XO+8DSk5SzcHusbul+RR/PIkbHwcxVMMmBYO4wkWWhS3XfF+suwWK9
BCjx4d+qqSa45APOgrohl8OfW1+08oPoafJyHOG0Uuz1iSSCQMOC+iAZNvC/vlDg
Z8o1nvBYCWToFFEgjRou8y74xdsko6cMLqOHEKrPGcYTMRgOn71HC/N4t1GO0QND
ArjWhuTTy9pjMcf2t2ulZUPgF8PGb6OR9h0/JyHfACyS54mBiK9ucFX0jetfj36l
wHhfJ76LdgpGbmDH6ev1c96iQa56orC3nnOOa5JAcv8+OoG/ENyFWR5lWRycz8Q7
wJ1vViLFkZw07KD8GSGDr7pJ5BjUxdB/IshzKpu/HxUtSavWzy4CnM2u/ukR5+pZ
GgfmQEwRam/5XkSPSjABtwa7ULuFEOXkKo6+UNAyPdYHMMccjqPwar2WPZgRbxMR
tTGDF793LAImErdD0ksxq00zBI8hycGEXeEqsiOvuEttNVFWkY2XhvoCyH1s7I5D
dSMhK08sHvJXY2F1r081G2J0UXM76VmvZ1HvdvSOgMDsp1CCN8yrMndQPB65c8vc
UpGiChv2o0W5wrNHONSJLKXWlFIMIqOktMZfzA9Z8NIvSpEZibiYXHdzwHAjuB2f
o6Zr
-----END CERTIFICATE-----
`, `-----BEGIN CERTIFICATE-----
MIIFoTCCA4mgAwIBAgIQczwBVefwpYwDZO3tyHclMjANBgkqhkiG9w0BAQsFADBa
MQswCQYDVQQGEwJDTjEwMC4GA1UECgwnQ2hpbmEgRmluYW5jaWFsIENlcnRpZmlj
YXRpb24gQXV0aG9yaXR5MRkwFwYDVQQDDBBDRkNBIEFDUyBURVNUIENBMB4XDTE1
MTAyMjAzMzgzMloXDTQzMDMwODAzMzgzMlowWjELMAkGA1UEBhMCQ04xMDAuBgNV
BAoMJ0NoaW5hIEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTEZMBcG
A1UEAwwQQ0ZDQSBBQ1MgVEVTVCBDQTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCC
AgoCggIBAOAwANJxh6UQjnSrjGqQ2gRMwaSPrj0qXrKAvfsfBaeWCHo1BJF5FII0
veKau4W76tr2z1a9UMeCurapIbWX/3AF1f3JDhI0t+E1i5F2JauVUSO8dGoL/7th
yiz1LnG8DBm8dM02RFjQjSlMA4OIrHB/33C5DYNRsiIZnpB6Aoxc7rAvPmwWnirM
wdEFEd01KzNyZJJ+HNuT/NTpkCRjBOTeoft8TE35kMN5B2JiVRVihqx2IUSOXUTk
iYMVxZUvJNwWaDokd0nAnJmFhYerhTt7xenEyy+Xkc9mQOI3WECdsfTD/4y80+Nj
vx2FgSMXOxhsXdImTBnrSXabauPYS6AHOgPjLMuUVTUvnSDGQSUWsX78s+/0wseD
oKyyLwMcP605sfrCtAdCTPmNIGgV4rnHC+l1JA9z+lpepOqM0kpaxmXphLjgyy+N
gpkh5aCj+pc/SzFlZCK9UuGgHb8M4x5fEG94OtAU//wGicwCNGpn2a2TsfYEguMP
OydV2BDkauccgmHO+1Xp1qaB3TcBxmDLm0T+/Anlk1zAyWpyk5M/hb6spm2heIdH
F87Fi3JBOik6UoRfMIsW3DKjNPdz7BbGIczomj38vSrt4IoiaWlxQPB4+UHnm9w+
lsLSpCGloy1J2dvCxExbODAFM9Kcd9VbYvq5uLqL/7faivr8pSufAgMBAAGjYzBh
MB8GA1UdIwQYMBaAFJNc5v4zMU9hMVYRjMxXx5zoC0b5MA8GA1UdEwEB/wQFMAMB
Af8wDgYDVR0PAQH/BAQDAgEGMB0GA1UdDgQWBBSTXOb+MzFPYTFWEYzMV8ec6AtG
+TANBgkqhkiG9w0BAQsFAAOCAgEAepGkL+SRw/wFZEd1SeaPPIsLq0hNepeFv4Zo
3f1M4eRtFKJxXPCpT8T2UDh44Bvmarn01B7UnzTfMNWEUERpexS/ASHlPmmoQqNz
hM4s4xNyTLL4JF4fnbE+OUrR1VFyrHujCNokSJDnxVHONWFRz1wNvdAoO+52UTRw
vcVA9l0McDQcESnf7heJU9qbpOGwU8opz00vcjGhoP9imb6TWOo+i0OnstyeoGBT
zMii5+VqU1n3ElPubxtLqUuYcfZimf3kiuU7TPk76c0udSuq5vwx7OlDIHQW/pd1
HeBN4NM9fw9ptWcb8H8vYHkUhCm0S1qt4mHV7SX7PXb9mnlaQcsNKS558flLgs+3
ek9M8t/ynyFAoTN2ihVuAEzLidC+MCmJsCfMdzNkVlSVue2/GZMx1vwl8ZiSm72C
lgHSAHb+pY/3SqLuXvCP1jI+asles2kBNhxMWDtCWOfm13k1jChvhKG7JId4XHh6
tyUmgS8Knnsjn2Ez7n8L3a+2DjvAO1oqdQeKZG/knHpylKGk5tt0A2JZ8bMNWXcE
DlVElu+fCAqKuAcomIpkIZ4LlN7vbIgxdd+RB5WywpwjTg8DGbRmKCQGohXDtxzJ
++nQ9HF3mcjyhoWf8xykVGDDxrG6ypgGA0uyRuGOYdl8xWZ2f4XLrBWlf61Exz42
7Q8IqjI=
-----END CERTIFICATE-----
`,
			},
			wantErr: false,
		},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			got, err := SplitCertChain(tt.args.input)
			if (err != nil) != tt.wantErr {
				t.Errorf("SplitCertChain() error = %v, wantErr %v", err, tt.wantErr)
				return
			}

			if !reflect.DeepEqual(len(got), len(tt.want)) {
				t.Errorf("SplitCertChain() got = %v, want %v", got, tt.want)
				return
			}

			for i, _ := range got {
				if !reflect.DeepEqual(got[i], tt.want[i]) {
					t.Errorf("SplitCertChain() got = %v, want %v", got[i], tt.want[i])
					return
				}
			}
		})
	}
}
